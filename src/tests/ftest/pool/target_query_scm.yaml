setup:
  start_agents_once: False
  start_servers_once: False
  server_config_namespace: /run/server_configurations/*/server_config/*

hosts:
  test_servers: 2
  test_clients: 1
timeout: 160

# Mux the SCM storage (DCPM and RAM)
server_configurations: !mux
  server_config_scm_dcpm:
    server_config:
      name: daos_server
      engines_per_host: 2
      engines:
        0:
          targets: 4
          pinned_numa_node: 0
          nr_xs_helpers: 1
          fabric_iface: ib0
          fabric_iface_port: 31317
          log_file: daos_engine_0.log
          storage:
            0:
              class: dcpm
              scm_list: ["/dev/pmem0"]
              scm_mount: /mnt/daos0
            1:
              class: nvme
              bdev_list: ["aaaa:aa:aa.a"]
        1:
          targets: 4
          pinned_numa_node: 1
          nr_xs_helpers: 1
          fabric_iface: ib1
          fabric_iface_port: 32317
          log_file: daos_engine_1.log
          storage:
            0:
              class: dcpm
              scm_list: ["/dev/pmem1"]
              scm_mount: /mnt/daos1
            1:
              class: nvme
              bdev_list: ["bbbb:bb:bb.b"]
  server_config_scm_ram:
    server_config:
      name: daos_server
      engines_per_host: 2
      engines:
        0:
          targets: 4
          pinned_numa_node: 0
          nr_xs_helpers: 1
          fabric_iface: ib0
          fabric_iface_port: 31317
          log_file: daos_engine_0.log
          storage:
            0:
              class: ram
              scm_mount: /mnt/daos0
              scm_size: 4
            1:
              class: nvme
              bdev_list: ["aaaa:aa:aa.a"]
        1:
          targets: 4
          pinned_numa_node: 1
          nr_xs_helpers: 1
          fabric_iface: ib1
          fabric_iface_port: 32317
          log_file: daos_engine_1.log
          storage:
            0:
              class: ram
              scm_mount: /mnt/daos1
              scm_size: 4
            1:
              class: nvme
              bdev_list: ["bbbb:bb:bb.b"]

pool:
  size: 80%

container:
  type: POSIX
  control_method: daos
  properties: rd_fac:0
  oclass: SX

ior:
  api: DFS
  transfer_size: 1048576  # 1MiB
  block_size: 134217728   # 128MiB
  flags: "-v -w -k"
  test_file: "/testFile"
  dfs_oclass: SX
  dfs_chunk: 1MiB
  dfs_destroy: false
  env_vars:
    - D_LOG_MASK=INFO

mpirun:
  bind_to: socket

# Maximal metadata size are empirically defined
scm_thresholds:
  metadata_max_size:
    - [524288, 4194304]  # [ 512KiB, 4MiB ]
    - [524288, 8388608]  # [ 512KiB, 8MiB ]
